/**
Rule the words! KKuTu Online
Copyright (C) 2017 JJoriping(op@jjo.kr)

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program. If not, see <http://www.gnu.org/licenses/>.
*/


var global={},L;!function(){function a(a,b,c){var d=new Date;d.setDate(d.getDate()+c),cookies=a+"="+escape(b)+"; path=/ ",void 0!==c&&(cookies+=";expires="+d.toGMTString()+";"),document.cookie=cookies}function b(a){var b=document.cookie,c=b.indexOf(a),d="";if(a+="=",-1!=c){c+=a.length;var e=b.indexOf(";",c);-1==e&&(e=b.length),d=b.substring(c,e)}return unescape(d)}function c(a){f[0],f[1];location.href="/login"}function d(a){location.href="/logout"}function e(a,b){var c=a.attr("id"),d=$("#ac-"+c);a.val()!=b&&((b=a.val())?$.get("http://jjo.kr/search?q="+encodeURI(b),function(b){var e,f=0;d.empty(),global["wl-"+c]=b.list.slice(0,10),global["wi-"+c]=-1;for(e in b.list){if(f++>=10)break;d.append($("<div>").attr("id","aci-"+b.list[e]._id).addClass("autocomp-item ellipse").html(b.list[e].profile.name).on("click",function(a){location.href="http://jjo.kr/users/"+$(a.currentTarget).attr("id").slice(4)}))}f?(d.show(),a.css("border-bottom-left-radius",0)):(d.hide(),a.css("border-bottom-left-radius",""))}):(d.hide(),a.css("border-bottom-left-radius",""))),g(e,200,a,b)}var f,g=setTimeout;$.prototype.hotkey=function(a,b){var c=$(this);return(a||$(window)).on("keydown",function(a){a.shiftKey||a.keyCode==b&&(c.trigger("click"),a.preventDefault())}),c},$.prototype.color=function(a){return $(this).css({color:a})},$.prototype.bgColor=function(a){return $(this).css({"background-color":a})},$.cookie=function(c,d){if(void 0===d)return b(c);a(c,d)},$(document).ready(function(a){function b(){if($("#account-info").html()===L.LOGIN)return alert("끄투리오로 부터 데이터를 이전하기 위해서는\n데이터를 받아올 계정으로 끄투한국에서 먼저 로그인을 하셔야 합니다.\n\n로그인 페이지로 이동합니다."),void(location.href="/login");location.href="/kkutuioMigration"}var e,h=$("#global-notice").hide(),i=$("#gn-content").html()||"";if(global.profile=$("#profile").html(),global.profile?global.profile=JSON.parse(global.profile):global.profile={},$.cookie("test","good"),"good"!=$.cookie("test")?h.html(i="쿠키 사용이 차단되어 있습니다. 로그인 관련 기능이 제한됩니다.<br>제한을 풀기 위해서는 브라우저 설정에서 쿠키 사용을 허용하도록 설정해야 합니다.<br>"+i):$.cookie("test",""),i.length>1&&h.show(),h.on("click",function(a){h.hide()}),$(window).on("resize",function(a){f=[$(window).width(),$(window).height()],$("#Middle").css("margin-left",Math.max(0,.5*f[0]-500)),$("#Bottom").width(f[0])}).on("mousemove",function(a){null!=e&&$(".expl-active").css({left:Math.min(a.clientX+5,f[0]-e[0]-12),top:Math.min(a.clientY+23,f[1]-e[1]-12)})}).trigger("resize"),$("#menu-kkutuio-migration-btn").on("click",function(a){b()}),$("#kkutuio-migration-btn").on("click",function(a){b()}),""==$.cookie("lc")&&$.cookie("lc","ko_KR"),global.profile.token)$("#account-info").html(global.profile.title||global.profile.name).on("click",function(a){confirm(L.ASK_LOGOUT)&&d(a)});else{if(window.FB)try{FB.logout()}catch(a){g(function(){FB.logout()},1e3)}$("#account-info").html(L.LOGIN).on("click",c)}global.watchInput($("#quick-search-tf")),(global.expl=function(a){(a?a.find(".expl"):$(".expl")).parent().addClass("expl-mother").on("mouseenter",function(a){var b=$(a.currentTarget).children(".expl");e=[b.width(),b.height()],$(".expl-active").removeClass("expl-active"),b.addClass("expl-active")}).on("mouseleave",function(a){$(a.currentTarget).children(".expl").removeClass("expl-active")})})()}),global.watchInput=function(a){var b=a.attr("id");return a.after($("<div>").addClass("autocomp").attr("id","ac-"+b).css({"margin-top":a.outerHeight(),width:a.outerWidth()-6}).hide()).on("keydown",function(a){var c,d=38==a.keyCode?-1:40==a.keyCode?1:0;d&&(c=global["wl-"+b])&&(-1==global["wi-"+b]&&-1==d&&(d=0),$(".autocomp-select").removeClass("autocomp-select"),global["wi-"+b]+=d,global["wi-"+b]<0&&(global["wi-"+b]+=c.length),global["wi-"+b]>=c.length&&(global["wi-"+b]=0),$("#aci-"+c[global["wi-"+b]]._id).addClass("autocomp-select"),a.preventDefault())}),g(e,200,a,a.val())},global.zeroPadding=function(a,b){var c=a.toString();return"000000000000000".slice(0,Math.max(0,b-c.length))+c},global.onPopup=function(a){location.href=a}}();